<!DOCTYPE html>
<html>
  <head>
    <title>Gallery</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  </head>

  <body>
    <div id="container">
      <div id="galleryBox"><div id="innerGallery"></div></div>
    </div>

  </body>
  <script type="text/javascript">

  // images[0].src; // => "images/image1.png"

  function init() {
    var images = [{
        "src": "images/image1.png",
        "title": "Title 1"
      },
      {
        "src": "images/image2.png",
        "title": "Title 2"
      },
      {
        "src": "images/image3.png",
        "title": "Title 3"
      },
      {
        "src": "images/image2.png",
        "title": "Title 2"
      },
      {
        "src": "images/image2.png",
        "title": "Title 2"
      },
      {
        "src": "images/image2.png",
        "title": "Title 2"
      },
      {
        "src": "images/image1.png",
        "title": "Title 1"
      },
      {
        "src": "images/image1.png",
        "title": "Title 1"
      },
      {
        "src": "images/image2.png",
        "title": "Title 2"
      },
      {
        "src": "images/image1.png",
        "title": "Title 1"
      },
      {
        "src": "images/image1.png",
        "title": "Title 1"
      },
      {
        "src": "images/image1.png",
        "title": "Title 1"
      },
      {
        "src": "images/image2.png",
        "title": "Title 2"
      },
      {
        "src": "images/image3.png",
        "title": "Title 3"
      },
      {
        "src": "images/image1.png",
        "title": "Title 1"
      },
    ];
    var container = document.getElementById("container");
    var galleryBox = document.getElementById("galleryBox");
    var gallery = document.getElementById("innerGallery");
    var lightBox = document.createElement("div");
    var nextPrevWrap = document.createElement("div");
    nextPrevWrap.id = "nextPrevWrap";
    var img = document.createElement("img");
    var titleBar = document.createElement("p");
    titleBar.className = "titleBar";
    var title;
    var width = img.clientWidth;
    var thumbnail;
    var dark = document.createElement("div");
    dark.id = "darkness";
    lightBox.id = "lightBox";
    var next = document.createElement("div");
    next.id = "next";
    next.innerHTML = ">";

    var previous = document.createElement("div");
    previous.id = "previous";
    previous.innerHTML = "<";
    var imageNumber = 0;
    // var rgb = getAverageRGB(document.getElementById("i"));
    // dark.style.backgroundColor = "rgb('+rgb.r+', '+rgb.b+', '+rgb.g+')";

    //TO DO: json object images/titles, dynamic previous/next, use CSS for prev/next placement DONE

    // for (i = 0; i < images.length; i++) { //Loads images from array
    //   thumbnail = document.createElement("img");
    //   thumbnail.className = "thumbnail";
    //   thumbnail.src = images[i];
    //   thumbnail.setAttribute('data-count', i); //adds number to img ALT attribute for previous/next feature
    //   thumbnail.addEventListener("click", expandImage);
    //   galleryBox.appendChild(thumbnail);
    // }
    for (var i in images) {
      thumbnail = document.createElement("img");
      thumbnail.className = "thumbnail";
      thumbnail.src = images[i].src;
      thumbnail.alt = images[i].title;
      // thumbnail.setAttribute('data-count', i); //adds number to img ALT attribute for previous/next feature
      thumbnail.addEventListener("click", expandImage);
      galleryBox.appendChild(thumbnail);
    }

    $('img').click(function (event) {
      imageNumber = $(this).index();
    });

    //Expands the clicked thumbnail
    function expandImage() {
      if (img.height > img.width) { //Determines which CSS ID is assigned to tall or wide images
        img.id = "expandedImage_height"; //If the image is taller than wide then it's height is set
      } else {
        img.id = "expandedImage_width"; //If the image is taller than wide then it's width is set
      }

      img.src = this.src; //Thumbnail clicked is set to img variable
      title = this.alt;
      gallery.appendChild(lightBox);
      galleryBox.appendChild(dark); //creates a dark background so the image can standout
      lightBox.appendChild(nextPrevWrap);
      nextPrevWrap.appendChild(titleBar);
      nextPrevWrap.appendChild(next); //Had to append previous/next to body otherwise a click would initiate removing functions
      nextPrevWrap.appendChild(previous);

      titleBar.innerHTML = title;


      nextPrevWrap.appendChild(img);
      nextPrevWrap.querySelector("#previous").addEventListener("click", previousImg);
      nextPrevWrap.querySelector("#next").addEventListener("click", nextImg);
      dark.addEventListener("click", removeImage);
      nextPrevWrap.querySelector("img").addEventListener("click", removeImage);
      nextPrevWrap.querySelector(".titleBar").addEventListener("click", removeImage);



    }

    function previousImg () {
      if (imageNumber > 0 || imageNumber < images.length - 1) {
        next.style.opacity = 1;
        previous.style.opacity = 1;
        nextPrevWrap.querySelector("#previous").addEventListener("click", previousImg);
        nextPrevWrap.querySelector("#next").addEventListener("click", nextImg);
      }
      if (img.height > img.width) { //Determines which CSS ID is assigned to tall or wide images
        img.id = "expandedImage_height"; //If the image is taller than wide then it's height is set
      } else {
        img.id = "expandedImage_width"; //If the image is taller than wide then it's width is set
      }
      if (imageNumber <= 0) {
        console.log("I am zero");
        nextPrevWrap.querySelector("#previous").removeEventListener("click", previousImg);
        previous.style.opacity = .2;
        //imageNumber = images.length - 1;
      } else {
        imageNumber--;
        console.log(imageNumber);
      }
      img.src = images[imageNumber].src;
      titleBar.innerHTML = images[imageNumber].title;
    }

    function nextImg() {
      if (imageNumber > 0 || imageNumber < images.length - 1) {
        next.style.opacity = 1;
        previous.style.opacity = 1;
        nextPrevWrap.querySelector("#previous").addEventListener("click", previousImg);
        nextPrevWrap.querySelector("#next").addEventListener("click", nextImg);
      }
      if (img.height > img.width) { //Determines which CSS ID is assigned to tall or wide images
        img.id = "expandedImage_height"; //If the image is taller than wide then it's height is set
      } else {
        img.id = "expandedImage_width"; //If the image is taller than wide then it's width is set
      }

      if (imageNumber == images.length - 1) {
        nextPrevWrap.querySelector("#next").removeEventListener("click", nextImg);
        next.style.opacity = .2;
        console.log("I'm the last one!");
      }
      imageNumber = (imageNumber + 1) % images.length;
      img.src = images[imageNumber].src;
      titleBar.innerHTML = images[imageNumber].title;
      console.log(imageNumber);
    }

    function removeImage() {
      imageNumber = 0;
      nextPrevWrap.querySelector("#previous").removeEventListener("click", previousImg);
      nextPrevWrap.querySelector("#next").removeEventListener("click", nextImg);
      nextPrevWrap.querySelector("img").removeEventListener("click", removeImage);
      nextPrevWrap.querySelector(".titleBar").removeEventListener("click", removeImage);
      dark.removeEventListener("click", removeImage);
      lightBox.removeEventListener("click", removeImage);
      lightBox.removeChild(nextPrevWrap);
      nextPrevWrap.removeChild(img);
      gallery.removeChild(lightBox);
      galleryBox.removeChild(dark);
      next.style.opacity = 1;
      previous.style.opacity = 1;
    }


  };
  window.onload = init();

  </script>
</html>
